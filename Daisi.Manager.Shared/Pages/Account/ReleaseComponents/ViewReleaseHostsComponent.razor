
<div class="px-4 pb-4">
    <div class="row">
        <div class="col-md-6">
            <h5 class="text-success">On Version @Release.Version (@onVersionHosts.Count)</h5>
            @if (!onVersionHosts.Any())
            {
                <p class="text-muted">No hosts are on this version yet.</p>
            }
            else
            {
                <ul class="list-group">
                    @foreach (var host in onVersionHosts)
                    {
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            @host.Name
                            @if (host.Status == HostStatus.Online)
                            {
                                <i title="Online" class="fa-duotone fa-dot text-success fa-2x p-0"></i>
                            }
                            else
                            {
                                <i title="Offline" class="fa-duotone fa-dot text-danger fa-2x p-0"></i>
                            }
                        </li>
                    }
                </ul>
            }
        </div>
        <div class="col-md-6">
            <h5 class="text-warning">Not Updated (@notUpdatedHosts.Count)</h5>
            @if (!notUpdatedHosts.Any())
            {
                <p class="text-muted">All hosts in this group are up to date.</p>
            }
            else
            {
                <ul class="list-group">
                    @foreach (var host in notUpdatedHosts)
                    {
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <span>@host.Name</span>
                            <span class="badge bg-warning text-dark">@(host.AppVersion ?? "unknown")</span>
                        </li>
                    }
                </ul>
            }
        </div>
    </div>
</div>

@code {
    [Parameter] public HostReleaseInfo Release { get; set; }
    [Parameter] public List<Host> HostsInGroup { get; set; } = new();
    [CascadingParameter] public IMudDialogInstance MudDialog { get; set; }

    List<Host> onVersionHosts = new();
    List<Host> notUpdatedHosts = new();

    protected override void OnParametersSet()
    {
        onVersionHosts = HostsInGroup
            .Where(h => h.AppVersion == Release.Version)
            .OrderBy(h => h.Name)
            .ToList();

        notUpdatedHosts = HostsInGroup
            .Where(h => h.AppVersion != Release.Version)
            .OrderBy(h => h.Name)
            .ToList();
    }
}
